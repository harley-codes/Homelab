# service-torrent

services:
  service-torrent-gluetun:
    image: qmcgaw/gluetun
    container_name: service-torrent-gluetun
    restart: unless-stopped
    security_opt:
      - no-new-privileges:true
    networks:
      - hotbox
    cap_add:
      - NET_ADMIN
    devices:
      - /dev/net/tun
    ports:
      - "51413:51413"
      - "51413:51413/udp"
    volumes:
      - service-torrent-gluetun-config:/gluetun
    environment:
      - VPN_SERVICE_PROVIDER=${VAR_LOCAL_VPN_SERVICE_PROVIDER}
      - VPN_TYPE=${VAR_LOCAL_VPN_TYPE}
      - WIREGUARD_PRIVATE_KEY=${VAR_LOCAL_WIREGUARD_PRIVATE_KEY}
      - SERVER_COUNTRIES=${VAR_LOCAL_SERVER_COUNTRIES}
    labels:
      traefik.enable: "true"
      # transmission
      traefik.http.routers.service-torrent-transmission.rule: "Host(`${VAR_GLOBAL_TORRENT_CLIENT_SUBDOMAIN}.${VAR_GLOBAL_ROOT_DOMAIN}`)"
      traefik.http.routers.service-torrent-transmission.entrypoints: "websecure"
      traefik.http.routers.service-torrent-transmission.tls: "true"
      traefik.http.routers.service-torrent-transmission.tls.certresolver: "cloudflare"
      traefik.http.routers.service-torrent-transmission.middlewares: "service-proxy-authelia@docker"
      traefik.http.routers.service-torrent-transmission.service: "service-torrent-transmission"
      traefik.http.services.service-torrent-transmission.loadbalancer.server.port: "9091"
      # overseerr
      traefik.http.routers.service-torrent-overseerr.rule: "Host(`${VAR_GLOBAL_OVERSEERR_SUBDOMAIN}.${VAR_GLOBAL_ROOT_DOMAIN}`)"
      traefik.http.routers.service-torrent-overseerr.entrypoints: "websecure"
      traefik.http.routers.service-torrent-overseerr.tls: "true"
      traefik.http.routers.service-torrent-overseerr.tls.certresolver: "cloudflare"
      traefik.http.routers.service-torrent-overseerr.service: "service-torrent-overseerr"
      traefik.http.services.service-torrent-overseerr.loadbalancer.server.port: "5055"
      # sonarr
      traefik.http.routers.service-torrent-sonarr.rule: "Host(`${VAR_GLOBAL_SONARR_SUBDOMAIN}.${VAR_GLOBAL_ROOT_DOMAIN}`)"
      traefik.http.routers.service-torrent-sonarr.entrypoints: "websecure"
      traefik.http.routers.service-torrent-sonarr.tls: "true"
      traefik.http.routers.service-torrent-sonarr.tls.certresolver: "cloudflare"
      traefik.http.routers.service-torrent-sonarr.service: "service-torrent-sonarr"
      traefik.http.services.service-torrent-sonarr.loadbalancer.server.port: "8989"
      # radarr
      traefik.http.routers.service-torrent-radarr.rule: "Host(`${VAR_GLOBAL_RADARR_SUBDOMAIN}.${VAR_GLOBAL_ROOT_DOMAIN}`)"
      traefik.http.routers.service-torrent-radarr.entrypoints: "websecure"
      traefik.http.routers.service-torrent-radarr.tls: "true"
      traefik.http.routers.service-torrent-radarr.tls.certresolver: "cloudflare"
      traefik.http.routers.service-torrent-radarr.service: "service-torrent-radarr"
      traefik.http.services.service-torrent-radarr.loadbalancer.server.port: "7878"
      # prowlarr
      traefik.http.routers.service-torrent-prowlarr.rule: "Host(`${VAR_GLOBAL_PROWLARR_SUBDOMAIN}.${VAR_GLOBAL_ROOT_DOMAIN}`)"
      traefik.http.routers.service-torrent-prowlarr.entrypoints: "websecure"
      traefik.http.routers.service-torrent-prowlarr.tls: "true"
      traefik.http.routers.service-torrent-prowlarr.tls.certresolver: "cloudflare"
      traefik.http.routers.service-torrent-prowlarr.service: "service-torrent-prowlarr"
      traefik.http.services.service-torrent-prowlarr.loadbalancer.server.port: "9696"

  service-torrent-transmission:
    image: linuxserver/transmission
    container_name: service-torrent-transmission
    restart: unless-stopped
    security_opt:
      - no-new-privileges:true
    network_mode: "service:service-torrent-gluetun"
    depends_on:
      - service-torrent-gluetun
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=${VAR_GLOBAL_TIMEZONE}
    volumes:
      - service-torrent-transmission-config:/config:rw
      - ${VAR_LOCAL_DOWNLOAD_PATH}:/downloads:rw

  service-torrent-overseerr:
    image: sctx/overseerr:latest
    container_name: service-torrent-overseerr
    restart: unless-stopped
    security_opt:
      - no-new-privileges:true
    network_mode: "service:service-torrent-gluetun"
    environment:
      - LOG_LEVEL=info
      - TZ=${VAR_GLOBAL_TIMEZONE}
    volumes:
      - service-torrent-overseerr-config:/app/config

  service-torrent-sonarr:
    image: lscr.io/linuxserver/sonarr:latest
    container_name: service-torrent-sonarr
    restart: unless-stopped
    security_opt:
      - no-new-privileges:true
    network_mode: "service:service-torrent-gluetun"
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=${VAR_GLOBAL_TIMEZONE}
    volumes:
      - service-torrent-sonarr-config:/config
      - ${VAR_LOCAL_DOWNLOAD_PATH}:/downloads
      - ${VAR_LOCAL_TV_PATH}:/tv

  service-torrent-radarr:
    image: lscr.io/linuxserver/radarr:latest
    container_name: service-torrent-radarr
    restart: unless-stopped
    security_opt:
      - no-new-privileges:true
    network_mode: "service:service-torrent-gluetun"
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=${VAR_GLOBAL_TIMEZONE}
    volumes:
      - service-torrent-radarr-config:/config
      - ${VAR_LOCAL_DOWNLOAD_PATH}:/downloads
      - ${VAR_LOCAL_MOVIES_PATH}:/movies

  service-torrent-prowlarr:
    image: lscr.io/linuxserver/prowlarr:latest
    container_name: service-torrent-prowlarr
    restart: unless-stopped
    security_opt:
      - no-new-privileges:true
    network_mode: "service:service-torrent-gluetun"
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=${VAR_GLOBAL_TIMEZONE}
    volumes:
      - service-torrent-prowlarr-config:/config

  service-torrent-flaresolverr:
    image: ghcr.io/flaresolverr/flaresolverr:latest
    container_name: service-torrent-flaresolverr
    restart: unless-stopped
    security_opt:
      - no-new-privileges:true
    network_mode: "service:service-torrent-gluetun"
    environment:
      - LOG_LEVEL=info
      - TZ=${VAR_GLOBAL_TIMEZONE}
    # Default port inside is 8191, no need to expose unless you want external access

networks:
  hotbox:
    external: true

volumes:
  service-torrent-gluetun-config:
  service-torrent-transmission-config:
  service-torrent-overseerr-config:
  service-torrent-sonarr-config:
  service-torrent-radarr-config:
  service-torrent-prowlarr-config:
